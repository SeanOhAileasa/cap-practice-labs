<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>
	Print content
</title><link href="ImprovingNetworkSecurity_files/print-styles.css" rel="stylesheet">
    <script src="ImprovingNetworkSecurity_files/jquery.min.js"></script>
    <script src="ImprovingNetworkSecurity_files/jspdf.js"></script>
    <script src="ImprovingNetworkSecurity_files/from_html.js"></script>
    <script src="ImprovingNetworkSecurity_files/addimage.js"></script>
    <script src="ImprovingNetworkSecurity_files/filesaver.js"></script>
    <script src="ImprovingNetworkSecurity_files/pl.js"></script>
</head>
<body>
    <form method="post" action="./vn-print-content.aspx" id="form1">
<div class="aspNetHidden">
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="TFO/1kze/j6r84gNSqNhLdr2GB34Tr1Za6i/zIHk0erDPVgncWT5iHv+si5MKmxqFiNqK0rHqYGRFSv/Fg4qL44rYI57VzQFLdgquDMNguQ=">
</div>

<div class="aspNetHidden">

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="918AB9A0">
</div>
    <div>
        

        
        
        <div id="panPrintAvailable">
	
            <div class="print-content-wrapper" id="print-content">
                <!--<button class="save-pdf">PDF</button>-->
                <h1>CompTIA Cybersecurity Analyst (CySA+)</h1>
                <h2>Improving Network Security</h2>
                <div class="print-content-index">
                    <ul>
                        <li>Introduction</li><li>Lab Topology</li><li>Exercise 1 - Network Security</li><li>Exercise 2 - Update Antimalware Signatures</li><li>Exercise 3 - Work with Snort</li><li>Review</li>
                    </ul>
                </div>
                <div class="print-content-content">
                    <h2 class="exercise-title" id="cn-m16-0"><b>Introduction</b></h2>

<div class="cn-metadata"><div>Intrusion prevention system (IPS) rules</div>

<div>Data loss prevention (DLP)</div>

<div>Endpoint detection and response (EDR)</div>

<div>Network access control (NAC)</div>

<div>Sinkholing</div>

<div>Malware signatures</div>

<div>Port Security</div>

<div>Snort</div>

</div>

<span class="atom-code hidden">9beca326-b493-4b0e-b3dc-d7dfb77df3c9</span>

<p id="cn-m16-11">Welcome to the <b>Improving Network Security </b>Practice Lab. In this module, you will be provided with the instructions and devices needed to develop your hands-on skills.</p>

<span class="atom-code hidden">dc640c20-9434-45ea-b7c2-6d4d6a196bfc</span>

<h2 class="cn-learningobjectives"><b>Learning Outcomes</b></h2>

<p id="cn-m16-15">In this module, you will complete the following exercises:</p>

<ul id="cn-m16-16">

<li id="cn-m16-16">Exercise 1 - Network Security</li>

<li id="cn-m16-17">Exercise 2 - Update Antimalware Signatures</li>

<li id="cn-m16-18">Exercise 3 - Work with Snort</li>

</ul>

<p id="cn-m16-19">After completing this module, you will be able to:</p>

<ul id="cn-m16-20">

<li id="cn-m16-20">Update Windows Defender</li>

<li id="cn-m16-21">Install Snort</li>

<li id="cn-m16-22">Download Snort Rules</li>

<li id="cn-m16-23">Running Snort Tool</li>

<li id="cn-m16-24">Create a Folder and the Rules File in the Snort Folder</li>

<li id="cn-m16-25">Modify the Snort Configuration File</li>

<li id="cn-m16-26">Re-run Snort IDS Tool</li>

</ul>

<p id="cn-m16-27">After completing this module, you will have further knowledge of:</p>

<ul id="cn-m16-28">

<li id="cn-m16-28">Data loss Prevention (DLP)</li>

<li id="cn-m16-29">Endpoint Detection and Response (EDR)</li>

<li id="cn-m16-30">Network Access Control (NAC)</li>

<li id="cn-m16-31">Sinkholing</li>

<li id="cn-m16-32">Port Security</li>

</ul>

<h2 class="cn-examobjectives"><b>Exam Objectives</b></h2>

<p id="cn-m16-34">The following exam objectives are covered in this lab:</p>

<ul id="cn-m16-35">

<li id="cn-m16-35">3.2 Given a scenario, implement configuration changes to existing controls to improve security.</li>

</ul>

<span class="cn-quote" id="cn-m16-36"><b><i>Note: </i></b><i>Our main 
focus is to cover the practical, hands-on aspects of the exam 
objectives. We recommend referring to course material or a search engine
 to research theoretical topics in more detail.</i></span>

<h2 class="cn-labduration"><b>Lab Duration</b></h2>

<p id="cn-m16-38">It will take approximately <b>1 hour </b>to complete this lab.</p>

<span class="atom-code hidden">1b317064-7b0c-48e0-845c-05a2d99e80c5</span>

<h2 class="cn-helpdandsupport"><b>Help and Support</b></h2>

<p id="cn-m16-42">For more information on using Practice Labs, please see our <b>Help and Support </b>page. You can also raise a technical support ticket from this page.</p>

<span class="cn-alert" id="cn-m16-43">Click <b>Next </b>to view the Lab topology used in this module.</span>

<span class="atom-code hidden">d2c53300-f951-45a9-9aa4-3d4ecae69e11</span>

<div class="print-exercise-break"></div><h2 class="exercise-title" id="cn-m16-45"><b>Lab Topology</b></h2>

<p id="cn-m16-46">During your session, you will have access to the following lab configuration.</p>

<p id="cn-m16-47"><img class="cn-img" id="cn-image-m16-c-0" src="ImprovingNetworkSecurity_files/image-m16-c-0.jpg" alt="Practice Labs screenshot."></p>

<p id="cn-m16-48">Depending on the exercises, you may or may not use all
 of the devices, but they are shown here in the layout to get an overall
 understanding of the topology of the lab.</p>

<ul id="cn-m16-49">

<li id="cn-m16-49"><b>PLABDC01 </b>- (Windows Server 2019 - Domain Server)</li>

<li id="cn-m16-50"><b>PLABDM01 </b>- (Windows Server 2019 - Domain Member)</li>

<li id="cn-m16-51"><b>PLABKALI01 </b>- (Kali Linux 2019 - Linux Kali)</li>

<li id="cn-m16-52"><b>PLABWIN10 </b>- (Windows 10 - Domain Member Workstation)</li>

<li id="cn-m16-53"><b>PLABCENTOS </b>- (Centos 8 Linux - Stand-alone Linux Server)</li>

<li id="cn-m16-54"><b>PLABALIENVAULT </b>- (Alien Vault Linux Security Management Platform)</li>

</ul>

<span class="cn-alert" id="cn-m16-55">Click <b>Next </b>to proceed to the first exercise.</span>
< <a href="https://github.com/SeanOhAileasa" id="NetworkSecurity">Home</a> | <a href="https://github.com/SeanOhAileasa/cap-practice-labs/blob/main/README.md">README</a> > 
<h2>CompTIA Cybersecurity Analyst (CySA+) Practice Labs</h2>
<div class="print-exercise-break"></div><h2 class="exercise-title" id="cn-m16-56"><b>Exercise 1 - Network Security</b></h2>

<p id="cn-m16-57">Network security cannot be built based on a single 
device or application. Some tools and applications complete the security
 of a network. You can have multiple security devices and applications, 
such as Intrusion Detection System (IDS), Intrusion Prevention System 
(IPS), Network Access Control (NAC), firewall, and antimalware 
applications.</p>

<p id="cn-m16-58">In this exercise, you will learn about the different components of network security.</p>

<h2 class="cn-learningobjectives"><b>Learning Outcomes</b></h2>

<p id="cn-m16-60">After completing this exercise, you will have further knowledge of:</p>

<ul id="cn-m16-61">

<li id="cn-m16-61">Data Loss Prevention (DLP)</li>

<li id="cn-m16-62">Endpoint Detection and Response (EDR)</li>

<li id="cn-m16-63">Network Access Control (NAC)</li>

<li id="cn-m16-64">Sinkholing</li>

<li id="cn-m16-65">Port Security</li>

</ul>

<h2 class="cn-devices"><b>Your Devices</b></h2>

<p id="cn-m16-67">This exercise contains supporting materials for CySA+.</p>

<p id="cn-m16-68"><img class="cn-img" id="cn-image-m16-c-1" src="ImprovingNetworkSecurity_files/image-m16-c-1.jpg" alt="Practice Labs screenshot."></p>

<h3 id="cn-m16-69"><b>Data Loss Prevention (DLP)</b></h3>

<p id="cn-m16-70">Data Loss Prevention or <b>DLP </b>is a set of rules that are defined to protect confidential and sensitive information. <b>DLP</b>,
 as an application, contains several rules that help you identify the 
type of data that users can share. For example, within an organization, 
when <b>DLP </b>is implemented, it can scan outbound Emails and track if any kind of sensitive or confidential information is being shared.</p>

<p id="cn-m16-71">You can have a rule defined that prevents sharing of 
financial reports or sharing of credit card numbers in an Email or its 
attachments. Without <b>DLP</b>, it is not possible to track such Emails with confidential information. However, with <b>DLP </b>implementation in place, as the administrator, you can define what type of information can the users share.</p>

<p id="cn-m16-72">When you share information with the users within an 
organization, you can set the permissions, such as forward or print. For
 example, you send a confidential management decision to your colleague.
 You, however, do not want a colleague to forward or print this Email. 
Such restrictions can be defined in the form of permissions.</p>

<p id="cn-m16-73">The key intent of <b>DLP </b>is to tackle insider threats and also to meet the regulation-driven privacy requirements. <b>DLP </b>has three key use cases:</p>

<ul id="cn-m16-74">

<li id="cn-m16-74"><b>Protect the personal information </b>- <b>DLP </b>is
 a good tool if your organization deals with Personally Identifiable 
Information (PII), Protected Health Information (PHI), or credit card 
information. These types of information are critical and are considered 
highly sensitive. With the help of DLP, this information can be 
protected.</li>

<li id="cn-m16-75"><b>Protect the Intellectual Property (IP) </b>- <b>DLP </b>can
 help an organization protect its IP information. For example, if an 
organization is into developing a unique product, it becomes critical 
for the organization to safeguard the product-related information. <b>DLP </b>can help in implementing protection.</li>

<li id="cn-m16-76"><b>Bring Data Visibility </b>- <b>DLP </b>can help 
you track the information that is being used by the users. For example, 
you can track who is using which information and who is sharing or 
attempting to share information.</li>

</ul>

<h3 id="cn-m16-78"><b>Endpoint Detection and Response (EDR)</b></h3>

<p id="cn-m16-79">Initially, there were traditional antivirus solutions,
 which could only detect and stop a virus or malware. However, as the 
malware and its variants got more sophisticated, the antivirus solutions
 evolved into Endpoint Detection and Response (<b>EDR</b>) tools, which could do a variety of tasks, such as:</p>

<ul id="cn-m16-80">

<li id="cn-m16-80">Collect information</li>

<li id="cn-m16-81">Record various activities on the endpoint</li>

<li id="cn-m16-82">Store different states and their related information</li>

</ul>

<p id="cn-m16-83">With this evolvement, <b>EDR </b>tools now act as 
preventive tools, which can perform a variety of tasks. For example, 
they can detect a malicious file from running on the systems. Each event
 gets logged, which can later be used for investigation purposes.</p>

<p id="cn-m16-84">One of the key capabilities of an <b>EDR </b>tool is that it not only detects the attack but also prevents the attack from spreading to the other systems on the network.</p>

<p id="cn-m16-85">Three key capabilities of <b>EDR </b>tools:</p>

<ul id="cn-m16-86">

<li id="cn-m16-86"><b>Data collection</b>: Can collect data from various processes within the endpoint. Some key processes can be user logins, running processes, etc.</li>

<li id="cn-m16-87"><b>Detection Engine</b>: Include a detection engine 
that performs the behavioral analysis of the endpoint activities. Any 
deviation from typical operations can be determined as malicious.</li>

<li id="cn-m16-88"><b>Data Recording</b>: Can also gather information 
about the attack, which can be useful in forensic investigation. Some of
 the advanced tools support real-time forensic information gathering, 
which can help in responding to the attack on an instant basis.</li>

<li id="cn-m16-89"><b>Centralized Console</b>: Provide a centralized management console that can be used by the security teams to manage several endpoints at one go.</li>

</ul>

<p id="cn-m16-91">Some key EDR tools are:</p>

<ul id="cn-m16-92">

<li id="cn-m16-92">Cynet 360 Security Platform</li>

<li id="cn-m16-93">Symantec Endpoint Protection</li>

<li id="cn-m16-94">RSA NetWitness Endpoint</li>

<li id="cn-m16-95">CrowdStrike Falcon Insight</li>

<li id="cn-m16-96">Cybereason Endpoint Detection and Response</li>

<li id="cn-m16-97">FireEye Endpoint Security</li>

</ul>

<h3 id="cn-m16-98"><b>Network Access Control (NAC)</b></h3>

<p id="cn-m16-99">When you connect to your network, either through a 
physical wire or remotely, the network access control application 
validates the state of your system. The main job of <b>NAC </b>is to ensure that any policy or endpoint connecting to the network meets the basic security level.</p>

<p id="cn-m16-100">There can be two stages in <b>NAC </b>when an endpoint is connecting to the network. These are largely dependent on how <b>NAC </b>is deployed in your network:</p>

<ul id="cn-m16-101">

<li id="cn-m16-101"><b>Pre-admission</b>: A set of policies are enforced
 on the endpoints that are connecting to the network. These policies 
validate if the endpoints meet the set security criteria. If not, then, 
depending on the design, they may be remediated or quarantined until 
they are compliant with the policies.</li>

<li id="cn-m16-102"><b>Post-admission</b>: A set of policies evaluates 
user actions. These users have been granted access to the network, but 
their actions determine how policies are enforced.</li>

</ul>

<p id="cn-m16-103"><b>NAC </b>can also be agent-based or agentless. In agent-based <b>NAC</b>,
 a small piece of the application is installed on the endpoint, which 
communicates with the network access control application. It determines 
the state of the endpoint and reports to <b>NAC</b>. An agent-based solution can also be using a dissolvable agent, which runs once on the system and then, based on the <b>NAC </b>policies, allows or denies access to the user system. After that, the agent is removed from the system.</p>

<p id="cn-m16-104">In agentless, the <b>NAC </b>uses the network inventory and scanning methods to determine the state of the endpoints.</p>

<p id="cn-m16-105"><b>NAC </b>can also be either in-band or out-of-band:</p>

<ul id="cn-m16-106">

<li id="cn-m16-106"><b>In-band</b>: A hardware appliance communicating with the network access control application would be considered as an in-band solution.</li>

<li id="cn-m16-107"><b>Out-of-band</b>: There is a small application 
that communicates with the network access control application, which is 
an agent-based solution. Since there is no dedicated hardware but only a
 network access control application, it is an out-of-band solution.</li>

</ul>

<h3 id="cn-m16-108"><b>Sinkholing</b></h3>

<p id="cn-m16-109">A sinkhole is either a single server or an entire 
network segment that is designed for malicious traffic redirection. When
 malicious traffic is detected on a network, the traffic is directed 
towards the sinkhole, which isolates traffic and does not let the 
traffic escape. This means that it contains malicious traffic within 
itself. Therefore, the malicious traffic, which was originally meant for
 the network, is no longer able to reach the network and is stuck within
 the sinkhole.</p>

<p id="cn-m16-110">For example, letâ€™s assume that you have a 
public-facing Web server and, therefore, is malicious traffic that is 
detected. This traffic could be Denial-of-Service (<b>DoS</b>) traffic, which is then directed to the sinkhole, which will absorb the traffic and not let it come out.</p>

<p id="cn-m16-111">Sinkholes are set up to detect the source of the 
attack and the methods that have been used to conduct the attack. You 
can use the DNS servers to divert the malicious traffic to the sinkhole.
 This method is largely used by Internet Service Providers (<b>ISPs</b>)
 who have a distributed set of sinkholes. Based on the traffic coming 
from a malicious IP address, the DNS servers can direct the traffic to 
its nearby sinkhole.</p>

<h3 id="cn-m16-112"><b>Port Security</b></h3>

<p id="cn-m16-113">Port security allows you to block devices from being 
connected to a specified switch port. Only a device with a specific MAC 
address can connect to the port. Any device that does not have a known 
MAC address will not be able to connect to the port.</p>

<p id="cn-m16-114">When a security violation occurs, it results in the port shutting down. The port goes into an <b>err-disabled </b>state.
  To fix this, an administrator would log into the switch and restart 
it. To avoid having to do this, it is possible to configure a port so 
that the <b>err-disable </b>state is not permanent.</p>

<p id="cn-m16-115">For example, your organization has many visitors who 
occasionally connect their systems to the network. You want to associate
 specific MAC addresses with interfaces on the switch. To meet the goal 
given in the scenario, you need to implement port security. When it is 
implemented, you will be able to assign MAC addresses to the interfaces 
on the switch.</p>

<span class="atom-code hidden">dc2a295a-ab17-4b52-8e1c-80389d10a470</span>
< <a href="https://github.com/SeanOhAileasa" id="UpdateAntimalwareSignatures">Home</a> | <a href="https://github.com/SeanOhAileasa/cap-practice-labs/blob/main/README.md">README</a> > 
<h2>CompTIA Cybersecurity Analyst (CySA+) Practice Labs</h2>
<div class="print-exercise-break"></div><h2 class="exercise-title" id="cn-m16-118"><b>Exercise 2 - Update Antimalware Signatures</b></h2>

<p id="cn-m16-119">Most operating systems have built-in antimalware 
programs that help to ward-off irritants such as viruses, unwanted email
 messages, and spyware. These irritants can be a waste of time for the 
user, while some of them might lead to a system malfunction, resulting 
in data or business loss.</p>

<p id="cn-m16-120">It is important to note that an antivirus or 
antimalware application only works well if it is updated with the latest
 signatures. Every day thousands of types of malware are released on the
 Internet. Therefore, the antimalware applications must always be 
updated with the latest signatures to catch the latest malware.</p>

<p id="cn-m16-121">In this exercise, you will learn to update the built-in antimalware application, which is <b>Windows Defender</b></p>

<h2 class="cn-learningobjectives"><b>Learning Outcomes</b></h2>

<p id="cn-m16-123">After completing this exercise, you will be able to:</p>

<ul id="cn-m16-124">

<li id="cn-m16-124">Update Windows Defender</li>

</ul>

<h2 class="cn-devices"><b>Your Devices</b></h2>

<p id="cn-m16-126">You will be using the following devices in this lab. Please power these on now.</p>

<p id="cn-m16-127"><img class="cn-img" id="cn-image-m16-c-2" src="ImprovingNetworkSecurity_files/image-m16-c-2.jpg" alt="Practice Labs screenshot."></p>

<ul id="cn-m16-128">

<li id="cn-m16-128"><b>PLABDC01 </b>- (Windows Server 2019 - Domain Server)</li>

<li id="cn-m16-129"><b>PLABWIN10 </b>- (Windows 10 - Domain Member Workstation)</li>

</ul>

<h3 id="cn-m16-130"><b>Task 1 -Update Windows Defender</b></h3>

<p id="cn-m16-131"><b>Windows Defender </b>is the built-in antimalware 
software in Windows 10. To keep the system safe, you must keep this 
software updated with the latest signatures.</p>

<p id="cn-m16-132">In this task, you will update <b>Windows Defender</b>. To do this, perform the following steps:</p>

<h4 id="cn-m16-133"><b><i>Step 1</i></b></h4>

<p id="cn-m16-134">Ensure you have powered on the devices mentioned in the introduction to the exercise.</p>

<p id="cn-m16-135">Connect to <b>PLABWIN10</b>.</p>

<p id="cn-m16-136">In the <b>Type here to search </b>text box, type the following:</p>

<pre id="cn-m16-137"><code>Windows Security

</code></pre>

<p id="cn-m16-138">From the search results, select <b>Windows Security</b>.</p>

<p id="cn-m16-139"></p><figure><img class="cn-img" id="cn-image-m16-c-3" src="ImprovingNetworkSecurity_files/image-m16-c-3.jpg" alt="Figure 1.1 Screenshot of PLABWIN10: Selecting Windows Security from the search results."><figcaption>Figure 1.1 Screenshot of PLABWIN10: Selecting Windows Security from the search results.</figcaption></figure><p></p>

<h4 id="cn-m16-143"><b><i>Step 2</i></b></h4>

<p id="cn-m16-144">In the right-hand pane, click <b>Virus &amp; threat protection</b>.</p>

<h4 id="cn-m16-147"><b><i>Step 3</i></b></h4>

<p id="cn-m16-148">On the <b>Virus &amp; threat protection </b>page, in the <b>Virus &amp; threat protection updates </b>section, notice the number of days since the definitions were last updated.</p>

<p id="cn-m16-149">The older the signature/definition, the more outdated it is, therefore, increasing the risk to your computer.</p>

<span class="cn-quote" id="cn-m16-150"><b><i>Note: </i></b><i>The number of days since the last update may vary in your lab environment. </i></span>

<p id="cn-m16-151"></p><figure><img class="cn-img" id="cn-image-m16-c-5" src="ImprovingNetworkSecurity_files/image-m16-c-5.jpg" alt="Figure 1.3 Screenshot of PLABWIN10: Showing the number of days since the updates were installed in the Virus &amp;amp; threat protection updates section."><figcaption>Figure
 1.3 Screenshot of PLABWIN10: Showing the number of days since the 
updates were installed in the Virus &amp; threat protection updates 
section.</figcaption></figure><p></p>

<h4 id="cn-m16-154"><b><i>Step 4</i></b></h4>

<p id="cn-m16-155">In the <b>Virus &amp; threat protection updates </b>section and click <b>Check for updates</b>.</p>

<p id="cn-m16-156"></p><figure><img class="cn-img" id="cn-image-m16-c-6" src="ImprovingNetworkSecurity_files/image-m16-c-6.jpg" alt="Figure 1.4 Screenshot of PLABWIN10: Scrolling down to the Virus &amp;amp; threat protection updates section and clicking Check for updates."><figcaption>Figure
 1.4 Screenshot of PLABWIN10: Scrolling down to the Virus &amp; threat 
protection updates section and clicking Check for updates.</figcaption></figure><p></p>

<h4 id="cn-m16-159"><b><i>Step 5</i></b></h4>

<p id="cn-m16-160">On the <b>Protection updates </b>page, click <b>Check for updates</b>. Make a note of the timestamp.</p>

<p id="cn-m16-161"></p><figure><img class="cn-img" id="cn-image-m16-c-7" src="ImprovingNetworkSecurity_files/image-m16-c-7.jpg" alt="Figure 1.5 Screenshot of PLABWIN10: Clicking Check for updates on the Protection updates page."><figcaption>Figure 1.5 Screenshot of PLABWIN10: Clicking Check for updates on the Protection updates page.</figcaption></figure><p></p>

<h4 id="cn-m16-164"><b><i>Step 6</i></b></h4>

<p id="cn-m16-165">Please wait for the updates to download and install.</p>

<span class="cn-alert" id="cn-m16-166"><b>Alert: </b>The updates may not
 complete on the Practice Labs platform. If 5 minutes have passed and 
the system is still checking for updates,<br>Please view the next step 
for the intended result of updating Virus and threat protection and then
 continue to the next exercise.</span>

<p id="cn-m16-167"></p><figure><img class="cn-img" id="cn-image-m16-c-8" src="ImprovingNetworkSecurity_files/image-m16-c-8.jpg" alt="Figure 1.6 Screenshot of PLABWIN10: Showing the progress of the update on the Protection updates page."><figcaption>Figure 1.6 Screenshot of PLABWIN10: Showing the progress of the update on the Protection updates page.</figcaption></figure><p></p>

<h4 id="cn-m16-170"><b><i>Step 7</i></b></h4>

<p id="cn-m16-171">Once the updates are done, you are navigated back to the Virus &amp; threat protection page. The <b>Virus &amp; threat protection updates </b>section states that <b>Security intelligence is up to date</b>.</p>

<p id="cn-m16-172">Notice that there is a change in the timestamp. This means new updates have been installed for the antimalware application.</p>

<p id="cn-m16-173"></p><figure><img class="cn-img" id="cn-image-m16-c-9" src="ImprovingNetworkSecurity_files/image-m16-c-9.jpg" alt="Figure 1.7 Screenshot of PLABWIN10: Showing the change in the timestamp for updates."><figcaption>Figure 1.7 Screenshot of PLABWIN10: Showing the change in the timestamp for updates.</figcaption></figure><p></p>

<span class="atom-code hidden">92fea127-9ca7-4825-8147-63c3d2f6f0d4</span>

<p id="cn-m16-177">Close all open windows.</p>
< <a href="https://github.com/SeanOhAileasa" id="WorkwithSnort">Home</a> | <a href="https://github.com/SeanOhAileasa/cap-practice-labs/blob/main/README.md">README</a> > 
<h2>CompTIA Cybersecurity Analyst (CySA+) Practice Labs</h2>
<div class="print-exercise-break"></div><h2 class="exercise-title" id="cn-m16-178"><b>Exercise 3 - Work with Snort</b></h2>

<p id="cn-m16-179">Snort is an open-source package that has the 
capability of intrusion detection system (IDS) and intrusion prevention 
system (IPS).</p>

<p id="cn-m16-180">In this exercise, you will learn to install Snort and configure it.</p>

<h2 class="cn-learningobjectives"><b>Learning Outcomes</b></h2>

<p id="cn-m16-182">After completing this exercise, you will be able to:</p>

<ul id="cn-m16-183">

<li id="cn-m16-183">Install Snort</li>

<li id="cn-m16-184">Download Snort Rules</li>

<li id="cn-m16-185">Running Snort Tool</li>

<li id="cn-m16-186">Create a Folder and the Rules File in the Snort Folder</li>

<li id="cn-m16-187">Modify the Snort Configuration File</li>

<li id="cn-m16-188">Re-run Snort IDS tool</li>

</ul>

<h2 class="cn-devices"><b>Your Devices</b></h2>

<p id="cn-m16-190">You will be using the following devices in this lab. Please power these on now.</p>

<p id="cn-m16-191"><img class="cn-img" id="cn-image-m16-c-10" src="ImprovingNetworkSecurity_files/image-m16-c-10.jpg" alt="Practice Labs screenshot."></p>

<ul id="cn-m16-192">

<li id="cn-m16-192"><b>PLABDC01 </b>- (Windows Server 2019 - Domain Server)</li>

<li id="cn-m16-193"><b>PLABWIN10 </b>- (Windows 10 - Domain Member Workstation)</li>

</ul>

<h3 id="cn-m16-197"><b>Task 1 - Installing Snort </b></h3>

<p id="cn-m16-198">Before you start using Snort, you need to install it. Snort helps you monitor the network traffic.</p>

<p id="cn-m16-199">In this task, you will download and install Snort. To do this, perform the following steps.</p>

<h4 id="cn-m16-200"><b><i>Step 1</i></b></h4>

<p id="cn-m16-201">Ensure that you have powered on the required devices. Connect to <b>PLABWIN10</b>.</p>

<p id="cn-m16-202">In the <b>Type here to search </b>text box, type:</p>

<pre id="cn-m16-203"><code>Internet Explorer

</code></pre>

<p id="cn-m16-204">Click <b>Internet Explorer </b>from the <b>Best Match </b>section.</p>

<p id="cn-m16-205"></p><figure><img class="cn-img" id="cn-image-m16-c-11" src="ImprovingNetworkSecurity_files/image-m16-c-11.jpg" alt="Figure 2.1 Screenshot of PLABWIN10: Starting Internet Explorer from the Best Match search."><figcaption>Figure 2.1 Screenshot of PLABWIN10: Starting Internet Explorer from the Best Match search.</figcaption></figure><p></p>

<h4 id="cn-m16-209"><b><i>Step 2</i></b></h4>

<p id="cn-m16-210">The <b>Intranet </b>Website is displayed. Click <b>Tools </b>and then click <b>Hacking Tools</b>.</p>

<p id="cn-m16-211">From the given list, locate <b>Snort_2_9_7_0_Installer.exe</b>. Click on <b>Snort_2_9_7_0_Installer.exe</b></p>

<p id="cn-m16-212"></p><figure><img class="cn-img" id="cn-image-m16-c-12" src="ImprovingNetworkSecurity_files/image-m16-c-12.jpg" alt="Figure 2.2 Screenshot of PLABWIN10: Locating the Snort file from the Hacking Tools list on the Intranet Website."><figcaption>Figure 2.2 Screenshot of PLABWIN10: Locating the Snort file from the Hacking Tools list on the Intranet Website.</figcaption></figure><p></p>

<h4 id="cn-m16-215"><b><i>Step 3</i></b></h4>

<p id="cn-m16-216">On the notification toolbar at the bottom of the page, click <b>Run</b>.</p>

<p id="cn-m16-217"></p><figure><img class="cn-img" id="cn-image-m16-c-13" src="ImprovingNetworkSecurity_files/image-m16-c-13.jpg" alt="Figure 2.3 Screenshot of PLABWIN10: Clicking Run from the notification bar."><figcaption>Figure 2.3 Screenshot of PLABWIN10: Clicking Run from the notification bar.</figcaption></figure><p></p>

<h4 id="cn-m16-220"><b><i>Step 4</i></b></h4>

<p id="cn-m16-221">When prompted with the <b>User Account Control </b>dialog box, click <b>Yes</b>.</p>

<p id="cn-m16-222"></p><figure><img class="cn-img" id="cn-image-m16-c-14" src="ImprovingNetworkSecurity_files/image-m16-c-14.jpg" alt="Figure 2.4 Screenshot of PLABWIN10: Clicking Yes in the User Account Control dialog box."><figcaption>Figure 2.4 Screenshot of PLABWIN10: Clicking Yes in the User Account Control dialog box.</figcaption></figure><p></p>

<h4 id="cn-m16-225"><b><i>Step 5</i></b></h4>

<p id="cn-m16-226">Minimize <b>Internet Explorer </b>in the background.</p>

<p id="cn-m16-227">On the <b>License Agreement </b>page of the <b>Snort 2.9.7.0 Setup </b>wizard, click <b>I Agree</b>.</p>

<p id="cn-m16-228"></p><figure><img class="cn-img" id="cn-image-m16-c-15" src="ImprovingNetworkSecurity_files/image-m16-c-15.jpg" alt="Figure 2.5 Screenshot of PLABWIN10: Showing the License Agreement page of the installation wizard. I Agree, is selected."><figcaption>Figure 2.5 Screenshot of PLABWIN10: Showing the License Agreement page of the installation wizard. I Agree, is selected.</figcaption></figure><p></p>

<h4 id="cn-m16-232"><b><i>Step 6</i></b></h4>

<p id="cn-m16-233">On the <b>Choose Components </b>page, keep the default selection and click <b>Next</b>.</p>

<p id="cn-m16-234"></p><figure><img class="cn-img" id="cn-image-m16-c-16" src="ImprovingNetworkSecurity_files/image-m16-c-16.jpg" alt="Figure 2.6 Screenshot of PLABWIN10: Clicking Next on the Choose Components page of the Snort installation wizard."><figcaption>Figure 2.6 Screenshot of PLABWIN10: Clicking Next on the Choose Components page of the Snort installation wizard.</figcaption></figure><p></p>

<h4 id="cn-m16-237"><b><i>Step 7</i></b></h4>

<p id="cn-m16-238">On the <b>Choose Install Location </b>page, keep the default installation path and click <b>Next</b>.</p>

<p id="cn-m16-239"></p><figure><img class="cn-img" id="cn-image-m16-c-17" src="ImprovingNetworkSecurity_files/image-m16-c-17.jpg" alt="Figure 2.7 Screenshot of PLABWIN10: Clicking Next on the Choose Install Location page of the Snort installation wizard."><figcaption>Figure 2.7 Screenshot of PLABWIN10: Clicking Next on the Choose Install Location page of the Snort installation wizard.</figcaption></figure><p></p>

<h4 id="cn-m16-242"><b><i>Step 8</i></b></h4>

<p id="cn-m16-243">The installation process starts. After it has completed, click <b>Close</b>.</p>

<p id="cn-m16-244"></p><figure><img class="cn-img" id="cn-image-m16-c-18" src="ImprovingNetworkSecurity_files/image-m16-c-18.jpg" alt="Figure 2.8 Screenshot of PLABWIN10: Completing the Snort installation. Close is selected."><figcaption>Figure 2.8 Screenshot of PLABWIN10: Completing the Snort installation. Close is selected.</figcaption></figure><p></p>

<h4 id="cn-m16-247"><b><i>Step 9</i></b></h4>

<p id="cn-m16-248">The system indicates that <b>Snort </b>has successfully been installed.</p>

<p id="cn-m16-249">Click <b>OK</b>.</p>

<p id="cn-m16-250"></p><figure><img class="cn-img" id="cn-image-m16-c-19" src="ImprovingNetworkSecurity_files/image-m16-c-19.jpg" alt="Figure 2.9 Screenshot of PLABWIN10: Showing the popup confirming that Snort has successfully been installed. OK is selected."><figcaption>Figure 2.9 Screenshot of PLABWIN10: Showing the popup confirming that Snort has successfully been installed. OK is selected.</figcaption></figure><p></p>

<h3 id="cn-m16-255"><b>Task 2 - Download Snort Rules</b></h3>

<p id="cn-m16-256">After you install Snort, you need to update its 
rules. In this task, you will download the rules from the Intranet 
Website and update Snort.</p>

<p id="cn-m16-257">To download the Snort rules file, perform the following steps:</p>

<h4 id="cn-m16-258"><b><i>Step 1</i></b></h4>

<p id="cn-m16-259">On <b>PLABWIN10 </b>device, restore <b>Internet Explorer </b>from the taskbar.</p>

<p id="cn-m16-260"></p><figure><img class="cn-img" id="cn-image-m16-c-20" src="ImprovingNetworkSecurity_files/image-m16-c-20.jpg" alt="Figure 2.10 Screenshot of PLABWIN10: Restoring the Internet Explorer window from the taskbar."><figcaption>Figure 2.10 Screenshot of PLABWIN10: Restoring the Internet Explorer window from the taskbar.</figcaption></figure><p></p>

<h4 id="cn-m16-263"><b><i>Step 2</i></b></h4>

<p id="cn-m16-264">While the <b>Tools and resources </b>webpage is open, scroll up and click <b>Tools</b>.</p>

<p id="cn-m16-265"></p><figure><img class="cn-img" id="cn-image-m16-c-21" src="ImprovingNetworkSecurity_files/image-m16-c-21.jpg" alt="Figure 2.11 Screenshot of PLABWIN10: Navigating to the Tools page. The Tools option is selected."><figcaption>Figure 2.11 Screenshot of PLABWIN10: Navigating to the Tools page. The Tools option is selected.</figcaption></figure><p></p>

<h4 id="cn-m16-269"><b><i>Step 3</i></b></h4>

<p id="cn-m16-270">On the <b>[..] &gt; Tools </b>path, scroll down and click <b>Snort</b>.</p>

<p id="cn-m16-271"></p><figure><img class="cn-img" id="cn-image-m16-c-22" src="ImprovingNetworkSecurity_files/image-m16-c-22.jpg" alt="Figure 2.12 Screenshot of PLABWIN10: Clicking the Snort folder."><figcaption>Figure 2.12 Screenshot of PLABWIN10: Clicking the Snort folder.</figcaption></figure><p></p>

<h4 id="cn-m16-274"><b><i>Step 4</i></b></h4>

<p id="cn-m16-275">You are redirected to <b>[..] &gt; Tools &gt; Snort </b>path.</p>

<p id="cn-m16-276">Click <b>blacklist.rules</b></p>

<p id="cn-m16-277"></p><figure><img class="cn-img" id="cn-image-m16-c-23" src="ImprovingNetworkSecurity_files/image-m16-c-23.jpg" alt="Figure 2.13 Screenshot of PLABWIN10: Downloading Snort rules from the intranet. blacklist.rules is selected."><figcaption>Figure 2.13 Screenshot of PLABWIN10: Downloading Snort rules from the intranet. blacklist.rules is selected.</figcaption></figure><p></p>

<h4 id="cn-m16-280"><b><i>Step 5</i></b></h4>

<p id="cn-m16-281">On the notification toolbar, click the <b>Save </b>drop-down and select <b>Save As</b>.</p>

<p id="cn-m16-282"></p><figure><img class="cn-img" id="cn-image-m16-c-24" src="ImprovingNetworkSecurity_files/image-m16-c-24.jpg" alt="Figure 2.14 Screenshot of PLABWIN10: Clicking the Save drop-down and selecting Save as."><figcaption>Figure 2.14 Screenshot of PLABWIN10: Clicking the Save drop-down and selecting Save as.</figcaption></figure><p></p>

<h4 id="cn-m16-285"><b><i>Step 6</i></b></h4>

<p id="cn-m16-286">On the <b>Save As </b>dialog box, expand <b>This PC </b>&gt; <b>Local Disk C </b>&gt; <b>Snort </b>and then click the <b>rules </b>folder.</p>

<p id="cn-m16-287">The <b>File name </b>box is automatically filled in, click <b>Save</b>.</p>

<p id="cn-m16-288"></p><figure><img class="cn-img" id="cn-image-m16-c-25" src="ImprovingNetworkSecurity_files/image-m16-c-25.jpg" alt="Figure 2.15 Screenshot of PLABWIN10: Saving the Snort rules to the rules folder. Save is selected."><figcaption>Figure 2.15 Screenshot of PLABWIN10: Saving the Snort rules to the rules folder. Save is selected.</figcaption></figure><p></p>

<h4 id="cn-m16-291"><b><i>Step 7</i></b></h4>

<p id="cn-m16-292">Close the notification bar.</p>

<p id="cn-m16-293"></p><figure><img class="cn-img" id="cn-image-m16-c-26" src="ImprovingNetworkSecurity_files/image-m16-c-26.jpg" alt="Figure 2.16 Screenshot of PLABWIN10: Closing the notification bar."><figcaption>Figure 2.16 Screenshot of PLABWIN10: Closing the notification bar.</figcaption></figure><p></p>

<p id="cn-m16-296">Minimize Internet Explorer</p>

<h3 id="cn-m16-298"><b>Task 3 - Running Snort Tool</b></h3>

<p id="cn-m16-299">After Snort has been installed, it should be tested 
to check the configuration. In this exercise, we will run and test the 
default configuration and add rule files.</p>

<p id="cn-m16-300">To start running Snort tool, perform the following steps:</p>

<h4 id="cn-m16-301"><b><i>Step 1</i></b></h4>

<p id="cn-m16-302">Ensure you are connected to the <b>PLABWIN10 </b>device.</p>

<p id="cn-m16-303">In the <b>Type here to search </b>text box, type the following:</p>

<pre id="cn-m16-304"><code>Command Prompt

</code></pre>

<p id="cn-m16-305">From the search results, right-click <b>Command Prompt </b>and select <b>Run as administrator</b>.</p>

<p id="cn-m16-306"></p><figure><img class="cn-img" id="cn-image-m16-c-27" src="ImprovingNetworkSecurity_files/image-m16-c-27.jpg" alt="Figure 2.17 Screenshot of PLABWIN10: Right-clicking Command Prompt from the search results and selecting Run as administrator."><figcaption>Figure 2.17 Screenshot of PLABWIN10: Right-clicking Command Prompt from the search results and selecting Run as administrator.</figcaption></figure><p></p>

<h4 id="cn-m16-309"><b><i>Step 2</i></b></h4>

<p id="cn-m16-310">When prompted with the <b>User Account Control </b>dialog box, click <b>Yes</b>.</p>

<p id="cn-m16-311"></p><figure><img class="cn-img" id="cn-image-m16-c-28" src="ImprovingNetworkSecurity_files/image-m16-c-28.jpg" alt="Figure 2.18 Screenshot of PLABWIN10: Clicking Yes on the User Account Control dialog box."><figcaption>Figure 2.18 Screenshot of PLABWIN10: Clicking Yes on the User Account Control dialog box.</figcaption></figure><p></p>

<h4 id="cn-m16-314"><b><i>Step 3</i></b></h4>

<p id="cn-m16-315">On the command prompt window,  to change to a different directory, type the following command:</p>

<pre id="cn-m16-316"><code>cd \snort\bin

</code></pre>

<p id="cn-m16-317">Press <b>Enter</b>.</p>

<p id="cn-m16-318"></p><figure><img class="cn-img" id="cn-image-m16-c-29" src="ImprovingNetworkSecurity_files/image-m16-c-29.jpg" alt="Figure 2.19 Screenshot of PLABWIN10: Changing from the current directory to the Snort directory. The above command has been entered."><figcaption>Figure
 2.19 Screenshot of PLABWIN10: Changing from the current directory to 
the Snort directory. The above command has been entered.</figcaption></figure><p></p>

<h4 id="cn-m16-322"><b><i>Step 4</i></b></h4>

<p id="cn-m16-323">Notice that you are in the <b>c:\snort\bin </b>directory. To display the available network interfaces for <b>Snort</b>, type the following command:</p>

<pre id="cn-m16-324"><code>snort -W

</code></pre>

<span class="cn-quote" id="cn-m16-325"><b><i>Note: </i></b><i>Snort switches, such as -W, are case-sensitive.</i></span>

<p id="cn-m16-326">Press <b>Enter</b>.</p>

<p id="cn-m16-327"></p><figure><img class="cn-img" id="cn-image-m16-c-30" src="ImprovingNetworkSecurity_files/image-m16-c-30.jpg" alt="Figure 2.20 Screenshot of PLABWIN10: Running the snort command."><figcaption>Figure 2.20 Screenshot of PLABWIN10: Running the snort command.</figcaption></figure><p></p>

<h4 id="cn-m16-330"><b><i>Step 5</i></b></h4>

<p id="cn-m16-331">The result of this command displays a network interface <b>#1 </b>and <b>2, </b>as indicated by the <b>Index </b>column.</p>

<p id="cn-m16-332"></p><figure><img class="cn-img" id="cn-image-m16-c-31" src="ImprovingNetworkSecurity_files/image-m16-c-31.jpg" alt="Figure 2.21 Screenshot of PLABWIN10: Showing the output of the snort command."><figcaption>Figure 2.21 Screenshot of PLABWIN10: Showing the output of the snort command.</figcaption></figure><p></p>

<h4 id="cn-m16-336"><b><i>Step 6</i></b></h4>

<p id="cn-m16-337">Let's use network interface <b>1 </b>to listen to all traffic.</p>

<p id="cn-m16-338">Type the following command:</p>

<pre id="cn-m16-339"><code>snort -i 1 -v

</code></pre>

<p id="cn-m16-340">Press <b>Enter</b>.</p>

<span class="cn-quote" id="cn-m16-341"><b><i>Note: </i></b><i>If you 
type -V instead of -v, then snort will not run continuously, and you 
will get to see the network interface details. To run Snort 
continuously, you must use -v.</i></span>

<p id="cn-m16-342"></p><figure><img class="cn-img" id="cn-image-m16-c-32" src="ImprovingNetworkSecurity_files/image-m16-c-32.jpg" alt="Figure 2.22 Screenshot of PLABWIN10: Running the snort command without various switches."><figcaption>Figure 2.22 Screenshot of PLABWIN10: Running the snort command without various switches.</figcaption></figure><p></p>

<h4 id="cn-m16-345"><b><i>Step 7</i></b></h4>

<p id="cn-m16-346">Snort will listen to network traffic on network interface <b>#1</b>.</p>

<p id="cn-m16-347">Notice that <b>Snort </b>runs continuously.</p>

<p id="cn-m16-348"></p><figure><img class="cn-img" id="cn-image-m16-c-33" src="ImprovingNetworkSecurity_files/image-m16-c-33.jpg" alt="Figure 2.23 Screenshot of PLABWIN10: Viewing Snort command output."><figcaption>Figure 2.23 Screenshot of PLABWIN10: Viewing Snort command output.</figcaption></figure><p></p>

<h4 id="cn-m16-352"><b><i>Step 8</i></b></h4>

<p id="cn-m16-353">First, break the previous command by pressing <b>CTRL </b>+ <b>C</b>. Ensure that the command prompt window is selected when you do this.</p>

<p id="cn-m16-354"><b>Snort </b>will exit.</p>

<p id="cn-m16-355">Note that a list of protocols is displayed with packet details.</p>

<p id="cn-m16-356"></p><figure><img class="cn-img" id="cn-image-m16-c-34" src="ImprovingNetworkSecurity_files/image-m16-c-34.jpg" alt="Figure 2.24 Screenshot of PLABWIN10: Viewing the protocol list in the Snort command output and breaking the snort command."><figcaption>Figure 2.24 Screenshot of PLABWIN10: Viewing the protocol list in the Snort command output and breaking the snort command.</figcaption></figure><p></p>

<h4 id="cn-m16-360"><b><i>Step 9</i></b></h4>

<p id="cn-m16-361">To capture and display packet payload, type the following command:</p>

<pre id="cn-m16-362"><code>snort -i 1 -vd

</code></pre>

<p id="cn-m16-363">Press <b>Enter</b>.</p>

<p id="cn-m16-364"></p><figure><img class="cn-img" id="cn-image-m16-c-35" src="ImprovingNetworkSecurity_files/image-m16-c-35.jpg" alt="Figure 2.25 Screenshot of PLABWIN10: Running a Snort command in the terminal window."><figcaption>Figure 2.25 Screenshot of PLABWIN10: Running a Snort command in the terminal window.</figcaption></figure><p></p>

<h4 id="cn-m16-367"><b><i>Step 10</i></b></h4>

<p id="cn-m16-368">The output of this command is displayed. Snort will continue running as it listens to the selected interface.</p>

<p id="cn-m16-369"></p><figure><img class="cn-img" id="cn-image-m16-c-36" src="ImprovingNetworkSecurity_files/image-m16-c-36.jpg" alt="Figure 2.26 Screenshot of PLABWIN10: Viewing the Snort command output."><figcaption>Figure 2.26 Screenshot of PLABWIN10: Viewing the Snort command output.</figcaption></figure><p></p>

<h4 id="cn-m16-372"><b><i>Step 11</i></b></h4>

<p id="cn-m16-373">Press <b>CTRL </b>+ <b>C </b>to break it. Ensure that the command prompt is selected when you do this.</p>

<p id="cn-m16-374">After you break the command, the protocol and packet details are displayed.</p>

<p id="cn-m16-375"></p><figure><img class="cn-img" id="cn-image-m16-c-37" src="ImprovingNetworkSecurity_files/image-m16-c-37.jpg" alt="Figure 2.27 Screenshot of PLABWIN10: Showing the snort command output and then breaking the command."><figcaption>Figure 2.27 Screenshot of PLABWIN10: Showing the snort command output and then breaking the command.</figcaption></figure><p></p>

<h4 id="cn-m16-378"><b><i>Step 12</i></b></h4>

<p id="cn-m16-379">Clear the screen with the following command:</p>

<pre id="cn-m16-380"><code>cls

</code></pre>

<p id="cn-m16-381">You will now run <b>Snort </b>in the IDS mode.</p>

<p id="cn-m16-382">Type the following command:</p>

<pre id="cn-m16-383"><code>snort&nbsp;-c&nbsp;&nbsp;c:\snort\etc\snort.conf&nbsp;&nbsp;-l&nbsp;&nbsp;c:\snort\log&nbsp;&nbsp;-K ascii

</code></pre>

<p id="cn-m16-384">Press <b>Enter</b>.</p>

<p id="cn-m16-385"></p><figure><img class="cn-img" id="cn-image-m16-c-38" src="ImprovingNetworkSecurity_files/image-m16-c-38.jpg" alt="Figure 2.28 Screenshot of PLABWIN10: Executing a command to run Snort in the IDS mode."><figcaption>Figure 2.28 Screenshot of PLABWIN10: Executing a command to run Snort in the IDS mode.</figcaption></figure><p></p>

<h4 id="cn-m16-389"><b><i>Step 13</i></b></h4>

<p id="cn-m16-390"><b>Snort </b>reports a fatal error.</p>

<p id="cn-m16-391">You will need to resolve this error to ensure that you can run <b>Snort </b>in IDS mode.</p>

<p id="cn-m16-392"></p><figure><img class="cn-img" id="cn-image-m16-c-39" src="ImprovingNetworkSecurity_files/image-m16-c-39.jpg" alt="Figure 2.29 Screenshot of PLABWIN10: Displaying the error for attempting to run Snort in IDS mode."><figcaption>Figure 2.29 Screenshot of PLABWIN10: Displaying the error for attempting to run Snort in IDS mode.</figcaption></figure><p></p>

<p id="cn-m16-394">Minimize the command prompt window.</p>

<h3 id="cn-m16-397"><b>Task 4 - Create a Folder and the Rules File in the Snort Folder</b></h3>

<p id="cn-m16-398">For <b>IDS </b>to run properly, you need to add rules
 in Snort. Rules decide what traffic can be labeled as appropriate or 
malicious that needs to be detected. You need to create folders and add 
the rules files in these folders.</p>

<p id="cn-m16-399">To create the folder and rules file, follow these steps:</p>

<h4 id="cn-m16-400"><b><i>Step 1</i></b></h4>

<p id="cn-m16-401">On <b>PLABWIN10</b>, launch <b>Windows Explorer </b>on the taskbar.</p>

<p id="cn-m16-402">Navigate to <b>C:\snort\lib</b>.</p>

<p id="cn-m16-403"></p><figure><img class="cn-img" id="cn-image-m16-c-40" src="ImprovingNetworkSecurity_files/image-m16-c-40.jpg" alt="Figure 2.30 Screenshot of PLABWIN10: Navigating to the c:\snort\lib path in the File Explorer window."><figcaption>Figure 2.30 Screenshot of PLABWIN10: Navigating to the c:\snort\lib path in the File Explorer window.</figcaption></figure><p></p>

<h4 id="cn-m16-406"><b><i>Step 2</i></b></h4>

<p id="cn-m16-407">In the right-hand pane, right-click and select <b>New </b>and then select <b>Folder</b>.</p>

<p id="cn-m16-408"></p><figure><img class="cn-img" id="cn-image-m16-c-41" src="ImprovingNetworkSecurity_files/image-m16-c-41.jpg" alt="Figure 2.31 Screenshot of PLABWIN10: Right-clicking in the right-hand pane, selecting New and then selecting Folder."><figcaption>Figure 2.31 Screenshot of PLABWIN10: Right-clicking in the right-hand pane, selecting New and then selecting Folder.</figcaption></figure><p></p>

<h4 id="cn-m16-411"><b><i>Step 3</i></b></h4>

<p id="cn-m16-412">Overwrite the new folder name and name the folder as <b>snort_dynamicrules</b>.</p>

<p id="cn-m16-413"></p><figure><img class="cn-img" id="cn-image-m16-c-42" src="ImprovingNetworkSecurity_files/image-m16-c-42.jpg" alt="Figure 2.32 Screenshot of PLABWIN10: Entering the name as snort_dynamicrules for the new folder."><figcaption>Figure 2.32 Screenshot of PLABWIN10: Entering the name as snort_dynamicrules for the new folder.</figcaption></figure><p></p>

<h4 id="cn-m16-417"><b><i>Step 4</i></b></h4>

<p id="cn-m16-418">Click the <b>View </b>tab.</p>

<p id="cn-m16-419"></p><figure><img class="cn-img" id="cn-image-m16-c-43" src="ImprovingNetworkSecurity_files/image-m16-c-43.jpg" alt="Figure 2.33 Screenshot of PLABWIN10: Clicking the View tab."><figcaption>Figure 2.33 Screenshot of PLABWIN10: Clicking the View tab.</figcaption></figure><p></p>

<h4 id="cn-m16-422"><b><i>Step 5</i></b></h4>

<p id="cn-m16-423">Click the <b>Options </b>drop-down and then select <b>Change folder and search options</b>.</p>

<p id="cn-m16-424"></p><figure><img class="cn-img" id="cn-image-m16-c-44" src="ImprovingNetworkSecurity_files/image-m16-c-44.jpg" alt="Figure 2.34 Screenshot of PLABWIN10: Modifying the view options. The View tab has been selected. Options has been clicked, and Change folder and search options have been chosen from the drop-down."><figcaption>Figure
 2.34 Screenshot of PLABWIN10: Modifying the view options. The View tab 
has been selected. Options has been clicked, and Change folder and 
search options have been chosen from the drop-down.</figcaption></figure><p></p>

<h4 id="cn-m16-428"><b><i>Step 6</i></b></h4>

<p id="cn-m16-429">On the <b>Folder Options </b>dialog box, click the <b>View </b>tab.</p>

<p id="cn-m16-430"></p><figure><img class="cn-img" id="cn-image-m16-c-45" src="ImprovingNetworkSecurity_files/image-m16-c-45.jpg" alt="Figure 2.35 Screenshot of PLABWIN10: Clicking the View tab on the Folder Options dialog box."><figcaption>Figure 2.35 Screenshot of PLABWIN10: Clicking the View tab on the Folder Options dialog box.</figcaption></figure><p></p>

<h4 id="cn-m16-433"><b><i>Step 7</i></b></h4>

<p id="cn-m16-434">On the <b>View </b>tab, clear the <b>Hide extensions for known file types </b>checkbox.</p>

<p id="cn-m16-435">Click <b>OK</b>.</p>

<p id="cn-m16-436"></p><figure><img class="cn-img" id="cn-image-m16-c-46" src="ImprovingNetworkSecurity_files/image-m16-c-46.jpg" alt="Figure 2.36 Screenshot of PLABWIN10: Permitting the file extensions to be viewed in Folder options. The above instructions have been executed, and OK is highlighted."><figcaption>Figure
 2.36 Screenshot of PLABWIN10: Permitting the file extensions to be 
viewed in Folder options. The above instructions have been executed, and
 OK is highlighted.</figcaption></figure><p></p>

<h4 id="cn-m16-440"><b><i>Step 8</i></b></h4>

<p id="cn-m16-441">Back in the <b>Windows Explorer </b>window, navigate to the <b>c:\snort\rules </b>folder.</p>

<p id="cn-m16-442"></p><figure><img class="cn-img" id="cn-image-m16-c-47" src="ImprovingNetworkSecurity_files/image-m16-c-47.jpg" alt="Figure 2.37 Screenshot of PLABWIN10: Navigating to the c:\snort\rules folder."><figcaption>Figure 2.37 Screenshot of PLABWIN10: Navigating to the c:\snort\rules folder.</figcaption></figure><p></p>

<h4 id="cn-m16-445"><b><i>Step 9</i></b></h4>

<p id="cn-m16-446">You need to create two text files now. In the right-hand pane, right-click in the empty area, select <b>New </b>and then select <b>Text Document</b>.</p>

<p id="cn-m16-447"></p><figure><img class="cn-img" id="cn-image-m16-c-48" src="ImprovingNetworkSecurity_files/image-m16-c-48.jpg" alt="Figure 2.38 Screenshot of PLABWIN10: Right-clicking in the empty area, select New and then select Text Document."><figcaption>Figure 2.38 Screenshot of PLABWIN10: Right-clicking in the empty area, select New and then select Text Document.</figcaption></figure><p></p>

<h4 id="cn-m16-450"><b><i>Step 10</i></b></h4>

<p id="cn-m16-451">Rename the text file with the following name:</p>

<pre id="cn-m16-452"><code>white_list.rules

</code></pre>

<p id="cn-m16-453">Click <b>Yes </b>when you get a warning about renaming a file.</p>

<p id="cn-m16-454"></p><figure><img class="cn-img" id="cn-image-m16-c-49" src="ImprovingNetworkSecurity_files/image-m16-c-49.jpg" alt="Figure 2.39 Screenshot of PLABWIN10: Renaming the file and clicking Yes on the warning."><figcaption>Figure 2.39 Screenshot of PLABWIN10: Renaming the file and clicking Yes on the warning.</figcaption></figure><p></p>

<h4 id="cn-m16-457"><b><i>Step 11</i></b></h4>

<p id="cn-m16-458">Make a copy of the <b>white_list.rules </b>file.</p>

<h4 id="cn-m16-459"><b><i>Step 12</i></b></h4>

<p id="cn-m16-460">Rename the text file with the following name:</p>

<pre id="cn-m16-461"><code>black_list.rules

</code></pre>

<p id="cn-m16-462"></p><figure><img class="cn-img" id="cn-image-m16-c-50" src="ImprovingNetworkSecurity_files/image-m16-c-50.jpg" alt="Figure 2.40 Screenshot of PLABWIN10: Renaming the text file."><figcaption>Figure 2.40 Screenshot of PLABWIN10: Renaming the text file.</figcaption></figure><p></p>

<h4 id="cn-m16-465"><b><i>Step 13</i></b></h4>

<p id="cn-m16-466">The <b>black_list.rules </b>and <b>white_list.rules </b>are now created and are empty.</p>

<span class="cn-quote" id="cn-m16-467"><b><i>Note: </i></b><i>If you want to get more information about writing your own rules, consult the snort documentation file.</i></span>

<p id="cn-m16-468">You need to ensure both the files have the <b>.rules </b>extension.</p>

<p id="cn-m16-469"></p><figure><img class="cn-img" id="cn-image-m16-c-51" src="ImprovingNetworkSecurity_files/image-m16-c-51.jpg" alt="Figure 2.41 Screenshot of PLABWIN10: Making rule files. The black_list.rules file has been created."><figcaption>Figure 2.41 Screenshot of PLABWIN10: Making rule files. The black_list.rules file has been created.</figcaption></figure><p></p>

<h4 id="cn-m16-473"><b><i>Step 14</i></b></h4>

<p id="cn-m16-474">Navigate to <b>c:\Snort\etc </b>folder. In the right-hand pane, right-click to select New and then select Folder.</p>

<p id="cn-m16-475"></p><figure><img class="cn-img" id="cn-image-m16-c-52" src="ImprovingNetworkSecurity_files/image-m16-c-52.jpg" alt="Figure 2.42 Screenshot of PLABWIN10: Right-clicking in the right-hand pane, selecting New and then selecting Folder."><figcaption>Figure 2.42 Screenshot of PLABWIN10: Right-clicking in the right-hand pane, selecting New and then selecting Folder.</figcaption></figure><p></p>

<h4 id="cn-m16-478"><b><i>Step 15</i></b></h4>

<p id="cn-m16-479">Name the folder as <b>WHITE_LIST_PATH</b>.</p>

<p id="cn-m16-480"></p><figure><img class="cn-img" id="cn-image-m16-c-53" src="ImprovingNetworkSecurity_files/image-m16-c-53.jpg" alt="Figure 2.43 Screenshot of PLABWIN10: Renaming the folder as WHITE_LIST_PATH."><figcaption>Figure 2.43 Screenshot of PLABWIN10: Renaming the folder as WHITE_LIST_PATH.</figcaption></figure><p></p>

<h4 id="cn-m16-483"><b><i>Step 16</i></b></h4>

<p id="cn-m16-484">Create a folder called <b>BLACK_LIST_PATH</b>.</p>

<p id="cn-m16-485"></p><figure><img class="cn-img" id="cn-image-m16-c-54" src="ImprovingNetworkSecurity_files/image-m16-c-54.jpg" alt="Figure 2.44 Screenshot of PLABWIN10: Creating a folder called BLACK_LIST_PATH."><figcaption>Figure 2.44 Screenshot of PLABWIN10: Creating a folder called BLACK_LIST_PATH.</figcaption></figure><p></p>

<p id="cn-m16-488">Minimize <b>Windows Explorer</b>.</p>

<h3 id="cn-m16-491"><b>Task 5 - Modify the Snort Configuration File</b></h3>

<p id="cn-m16-492">Before you can have <b>Snort </b>up and running, you need to modify its configuration file and then re-run the <b>Snort IDS tool</b>.</p>

<p id="cn-m16-493">In this task, you will modify a configuration file to resolve the error that you found in an earlier task.</p>

<h4 id="cn-m16-494"><b><i>Step 1</i></b></h4>

<p id="cn-m16-495">Ensure you are connected to the <b>PLABWIN10 </b>device.</p>

<p id="cn-m16-496">On the <b>PLABWIN10 </b>device, click <b>Start</b>, and then select <b>Notepad</b>++.</p>

<p id="cn-m16-497"></p><figure><img class="cn-img" id="cn-image-m16-c-55" src="ImprovingNetworkSecurity_files/image-m16-c-55.jpg" alt="Figure 2.45 Screenshot of PLABWIN10: Starting up Notepad ++ from the Start menu."><figcaption>Figure 2.45 Screenshot of PLABWIN10: Starting up Notepad ++ from the Start menu.</figcaption></figure><p></p>

<h4 id="cn-m16-500"><b><i>Step 2</i></b></h4>

<p id="cn-m16-501">In <b>Notepad</b>++, click <b>File </b>and select <b>Open</b>.</p>

<p id="cn-m16-502"></p><figure><img class="cn-img" id="cn-image-m16-c-56" src="ImprovingNetworkSecurity_files/image-m16-c-56.jpg" alt="Figure 2.46 Screenshot of PLABWIN10: Clicking File and selecting Open in the Notepad++ window."><figcaption>Figure 2.46 Screenshot of PLABWIN10: Clicking File and selecting Open in the Notepad++ window.</figcaption></figure><p></p>

<h4 id="cn-m16-505"><b><i>Step 3</i></b></h4>

<p id="cn-m16-506">On the <b>Open </b>dialog box, expand <b>Local Disk C </b>&gt; the <b>Snort </b>folder.</p>

<p id="cn-m16-507">Click the <b>etc. </b>folder.</p>

<p id="cn-m16-508">Notice that several files are available.</p>

<p id="cn-m16-509">On the details pane, click <b>snort.conf </b>and select <b>Open</b>.</p>

<p id="cn-m16-510"></p><figure><img class="cn-img" id="cn-image-m16-c-57" src="ImprovingNetworkSecurity_files/image-m16-c-57.jpg" alt="Figure 2.47 Screenshot of PLABWIN10: Opening the snort.conf file for editing."><figcaption>Figure 2.47 Screenshot of PLABWIN10: Opening the snort.conf file for editing.</figcaption></figure><p></p>

<h4 id="cn-m16-514"><b><i>Step 4</i></b></h4>

<p id="cn-m16-515">The <b>snort.conf </b>file opens.</p>

<p id="cn-m16-516">Click the <b>Search </b>tab and then select <b>Replace</b>.</p>

<p id="cn-m16-517"></p><figure><img class="cn-img" id="cn-image-m16-c-58" src="ImprovingNetworkSecurity_files/image-m16-c-58.jpg" alt="Figure 2.48 Screenshot of PLABWIN10: Editing the snort.conf file. The Search tab has been clicked and Replace selected."><figcaption>Figure 2.48 Screenshot of PLABWIN10: Editing the snort.conf file. The Search tab has been clicked and Replace selected.</figcaption></figure><p></p>

<h4 id="cn-m16-521"><b><i>Step 5</i></b></h4>

<p id="cn-m16-522">You will find all instances of <b>ipvar </b>and replace it with <b>var</b>.</p>

<p id="cn-m16-523">On the <b>Replace </b>dialog box, click in the <b>Find what </b>text box and type:</p>

<pre id="cn-m16-524"><code>ipvar

</code></pre>

<p id="cn-m16-525">Click in the <b>Replace with </b>text box, and type:</p>

<pre id="cn-m16-526"><code>var

</code></pre>

<p id="cn-m16-527">Click <b>Replace All</b>.</p>

<p id="cn-m16-528"></p><figure><img class="cn-img" id="cn-image-m16-c-59" src="ImprovingNetworkSecurity_files/image-m16-c-59.jpg" alt="Figure 2.49 Screenshot of PLABWIN10: Finding and Replacing values in Snort.conf file. The Replace All button is highlighted."><figcaption>Figure 2.49 Screenshot of PLABWIN10: Finding and Replacing values in Snort.conf file. The Replace All button is highlighted.</figcaption></figure><p></p>

<h4 id="cn-m16-532"><b><i>Step 6</i></b></h4>

<p id="cn-m16-533">The <b>Replace </b>dialog box is displayed.</p>

<p id="cn-m16-534">In the bottom left of the dialog box, the blue text indicates that it has searched the document, and <b>11 </b>occurrences were replaced.</p>

<span class="cn-quote" id="cn-m16-535"><b><i>Note: </i></b><i>In your lab environment, the number of occurrences may differ.</i></span>

<p id="cn-m16-536">Click <b>Close</b>.</p>

<p id="cn-m16-537"></p><figure><img class="cn-img" id="cn-image-m16-c-60" src="ImprovingNetworkSecurity_files/image-m16-c-60.jpg" alt="Figure 2.50 Screenshot of PLABWIN10: Editing the snort.conf file."><figcaption>Figure 2.50 Screenshot of PLABWIN10: Editing the snort.conf file.</figcaption></figure><p></p>

<h4 id="cn-m16-541"><b><i>Step 7</i></b></h4>

<p id="cn-m16-542">Click the <b>Search </b>menu and select <b>Find</b>.</p>

<p id="cn-m16-543"></p><figure><img class="cn-img" id="cn-image-m16-c-61" src="ImprovingNetworkSecurity_files/image-m16-c-61.jpg" alt="Figure 2.51 Screenshot of PLABWIN10: Clicking the Search menu and selecting the File option."><figcaption>Figure 2.51 Screenshot of PLABWIN10: Clicking the Search menu and selecting the File option.</figcaption></figure><p></p>

<h4 id="cn-m16-546"><b><i>Step 8</i></b></h4>

<p id="cn-m16-547">On the <b>Find </b>dialog box, click in the <b>Find what </b>text box and type:</p>

<pre id="cn-m16-548"><code>dynamicpreprocessor directory

</code></pre>

<p id="cn-m16-549">Click the <b>Find Next </b>button.</p>

<p id="cn-m16-550"></p><figure><img class="cn-img" id="cn-image-m16-c-62" src="ImprovingNetworkSecurity_files/image-m16-c-62.jpg" alt="Figure 2.52 Screenshot of PLABWIN10: Locating values in the snort.conf file. The above text has been entered, and the Find Next button is selected."><figcaption>Figure
 2.52 Screenshot of PLABWIN10: Locating values in the snort.conf file. 
The above text has been entered, and the Find Next button is selected.</figcaption></figure><p></p>

<h4 id="cn-m16-554"><b><i>Step 9</i></b></h4>

<p id="cn-m16-555">After the <b>dynamicpreprocessor directory </b>keyword is found, you will notice a highlight or a selection at the back of the <b>Find </b>dialog box.</p>

<p id="cn-m16-556">Move the <b>Find </b>dialog box out of the way so you can see the highlighted section.</p>

<p id="cn-m16-557">Locate the <b>dynamicpreprocessor directory </b>section.</p>

<p id="cn-m16-558">Change the path located beside <b>dynamicpreprocessor directory </b>to:</p>

<pre id="cn-m16-559"><code>c:\Snort\lib\snort_dynamicpreprocessor

</code></pre>

<p id="cn-m16-560"></p><figure><img class="cn-img" id="cn-image-m16-c-63" src="ImprovingNetworkSecurity_files/image-m16-c-63.jpg" alt="Figure 2.53 Screenshot of PLABWIN10: Changing values in the snort.conf file. The highlighted section is visible."><figcaption>Figure 2.53 Screenshot of PLABWIN10: Changing values in the snort.conf file. The highlighted section is visible.</figcaption></figure><p></p>

<h4 id="cn-m16-563"><b><i>Step 10</i></b></h4>

<p id="cn-m16-564">Click on the <b>Find </b>dialog box to activate it.</p>

<p id="cn-m16-565">Then, click the <b>Close </b>button.</p>

<p id="cn-m16-566"></p><figure><img class="cn-img" id="cn-image-m16-c-64" src="ImprovingNetworkSecurity_files/image-m16-c-64.jpg" alt="Figure 2.54 Screenshot of PLABWIN10: Closing the Find dialog box."><figcaption>Figure 2.54 Screenshot of PLABWIN10: Closing the Find dialog box.</figcaption></figure><p></p>

<h4 id="cn-m16-569"><b><i>Step 11</i></b></h4>

<p id="cn-m16-570">Perform the same editing changes to the following lines, numbered 250 and 253.</p>

<p id="cn-m16-571">250 is currently:</p>

<pre id="cn-m16-572"><code>dynamicengine /usr/local/lib/snort_dynamicengine/libsf_engine.so

</code></pre>

<p id="cn-m16-573">253 is currently:</p>

<pre id="cn-m16-574"><code>dynamicdetection directory /usr/local/lib/snort_dynamicrules

</code></pre>

<p id="cn-m16-575"><b>Change </b>them so that they read as the following:</p>

<p id="cn-m16-576">250:</p>

<pre id="cn-m16-577"><code>dynamicengine c:\Snort\lib\snort_dynamicengine\sf_engine.dll

</code></pre>

<p id="cn-m16-578">253:</p>

<pre id="cn-m16-579"><code>dynamicdetection directory c:\Snort\lib\snort_dynamicrules

</code></pre>

<p id="cn-m16-580"></p><figure><img class="cn-img" id="cn-image-m16-c-65" src="ImprovingNetworkSecurity_files/image-m16-c-65.jpg" alt="Figure 2.55 Screenshot of PLABWIN10: Replacing the values in the snort.conf file."><figcaption>Figure 2.55 Screenshot of PLABWIN10: Replacing the values in the snort.conf file.</figcaption></figure><p></p>

<h4 id="cn-m16-582"><b><i>Step 12</i></b></h4>

<p id="cn-m16-583">For this step, you will comment on keywords that start with <b>pre-processor normalize</b>.</p>

<p id="cn-m16-584">Click <b>Search </b>and select <b>Replace</b>.</p>

<h4 id="cn-m16-585"><b><i>Step 13</i></b></h4>

<p id="cn-m16-586">On the <b>Replace </b>dialog box, click in the <b>Find what </b>text box and type:</p>

<pre id="cn-m16-587"><code>preprocessor normalize

</code></pre>

<p id="cn-m16-588">Click in the <b>Replace with </b>text box and type:</p>

<pre id="cn-m16-589"><code>#preprocessor normalize

</code></pre>

<p id="cn-m16-590">Click <b>Replace All</b>.</p>

<p id="cn-m16-591"></p><figure><img class="cn-img" id="cn-image-m16-c-66" src="ImprovingNetworkSecurity_files/image-m16-c-66.jpg" alt="Figure 2.56 Screenshot of PLABWIN10: Searching and replacing values in the snort.conf file."><figcaption>Figure 2.56 Screenshot of PLABWIN10: Searching and replacing values in the snort.conf file.</figcaption></figure><p></p>

<h4 id="cn-m16-594"><b><i>Step 14</i></b></h4>

<p id="cn-m16-595">The <b>Replace </b>dialog box reports that â€œ<b>5 occurrences were replaced</b>.â€ This report is visible in the bottom left of the dialog box.</p>

<span class="cn-quote" id="cn-m16-596"><b><i>Note: </i></b><i>In your lab environment, the number of occurrences may differ.</i></span>

<p id="cn-m16-597">Click <b>Close</b>.</p>

<p id="cn-m16-598"></p><figure><img class="cn-img" id="cn-image-m16-c-67" src="ImprovingNetworkSecurity_files/image-m16-c-67.jpg" alt="Figure 2.57 Screenshot of PLABWIN10: Showing the result of replacing values and their count in the snort.conf file. Close is selected."><figcaption>Figure
 2.57 Screenshot of PLABWIN10: Showing the result of replacing values 
and their count in the snort.conf file. Close is selected.</figcaption></figure><p></p>

<h4 id="cn-m16-602"><b><i>Step 15</i></b></h4>

<p id="cn-m16-603">Notice that â€œ#â€ is now appended to the <b>preprocessor normalize </b>keywords.</p>

<p id="cn-m16-604"></p><figure><img class="cn-img" id="cn-image-m16-c-68" src="ImprovingNetworkSecurity_files/image-m16-c-68.jpg" alt="Figure 2.58 Screenshot of PLABWIN10: Appending # in front of a few parameters in the snort.conf file."><figcaption>Figure 2.58 Screenshot of PLABWIN10: Appending # in front of a few parameters in the snort.conf file.</figcaption></figure><p></p>

<h4 id="cn-m16-608"><b><i>Step 16</i></b></h4>

<p id="cn-m16-609">Click the <b>Search </b>menu and select <b>Find</b>â€¦</p>

<p id="cn-m16-610">On the <b>Find </b>dialog box, click in the <b>Find what </b>text box, type:</p>

<pre id="cn-m16-611"><code>var WHITE_LIST_PATH

</code></pre>

<p id="cn-m16-612">Click <b>Find Next</b>.</p>

<p id="cn-m16-613"></p><figure><img class="cn-img" id="cn-image-m16-c-69" src="ImprovingNetworkSecurity_files/image-m16-c-69.jpg" alt="Figure 2.59 Screenshot of PLABWIN10: Finding and replacing values in the snort.conf file."><figcaption>Figure 2.59 Screenshot of PLABWIN10: Finding and replacing values in the snort.conf file.</figcaption></figure><p></p>

<h4 id="cn-m16-616"><b><i>Step 17</i></b></h4>

<p id="cn-m16-617">Beside the <b>var WHITE_LIST_PATH </b>keyword, replace the  <b>.. /rules </b>with:</p>

<pre id="cn-m16-618"><code>c:\Snort\rules

</code></pre>

<p id="cn-m16-619">The statement should look like the following:</p>

<pre id="cn-m16-620"><code>var WHITE_LIST_PATH c:\snort\rules

</code></pre>

<p id="cn-m16-621">Repeat the same for var <b>BLACK_LIST_PATH </b>and add the same path, <b>c:\snort\rules</b>.</p>

<p id="cn-m16-622"></p><figure><img class="cn-img" id="cn-image-m16-c-70" src="ImprovingNetworkSecurity_files/image-m16-c-70.jpg" alt="Figure 2.60 Screenshot of PLABWIN10: Finding and replacing values in the snort.conf file."><figcaption>Figure 2.60 Screenshot of PLABWIN10: Finding and replacing values in the snort.conf file.</figcaption></figure><p></p>

<h4 id="cn-m16-625"><b><i>Step 18</i></b></h4>

<p id="cn-m16-626">Click again on the <b>Find </b>dialog box to activate it.</p>

<p id="cn-m16-627">Click in the <b>Find what </b>text box and type:</p>

<pre id="cn-m16-628"><code>$WHITE_LIST

</code></pre>

<p id="cn-m16-629">Click <b>Find Next</b>.</p>

<p id="cn-m16-630"></p><figure><img class="cn-img" id="cn-image-m16-c-71" src="ImprovingNetworkSecurity_files/image-m16-c-71.jpg" alt="Figure 2.61 Screenshot of PLABWIN10: Finding value in the snort.conf file."><figcaption>Figure 2.61 Screenshot of PLABWIN10: Finding value in the snort.conf file.</figcaption></figure><p></p>

<h4 id="cn-m16-633"><b><i>Step 19</i></b></h4>

<p id="cn-m16-634">Beside the whitelist keyword, change <b>$WHITE_LIST_PATH/white_list.rules, \</b></p>

<p id="cn-m16-635">to:</p>

<pre id="cn-m16-636"><code>c:\snort\rules\white_list.rules, \

</code></pre>

<p id="cn-m16-637">Change <b>$BLACK_LIST_PATH/black_list.rules</b></p>

<p id="cn-m16-638">to:</p>

<pre id="cn-m16-639"><code>c:\snort\rules\black_list.rules

</code></pre>

<p id="cn-m16-640"></p><figure><img class="cn-img" id="cn-image-m16-c-72" src="ImprovingNetworkSecurity_files/image-m16-c-72.jpg" alt="Figure 2.62 Screenshot of PLABWIN10: Finding values in the snort.conf file. The relevant text has been changed."><figcaption>Figure 2.62 Screenshot of PLABWIN10: Finding values in the snort.conf file. The relevant text has been changed.</figcaption></figure><p></p>

<h4 id="cn-m16-643"><b><i>Step 20</i></b></h4>

<p id="cn-m16-644">Click again on the <b>Find </b>dialog box.</p>

<p id="cn-m16-645">In the <b>Find what </b>text box, type:</p>

<pre id="cn-m16-646"><code>$RULE_PATH/blacklist.rules

</code></pre>

<p id="cn-m16-647">Click <b>Find Next</b>.</p>

<p id="cn-m16-648"></p><figure><img class="cn-img" id="cn-image-m16-c-73" src="ImprovingNetworkSecurity_files/image-m16-c-73.jpg" alt="Figure 2.63 Screenshot of PLABWIN10: Finding value in the snort.conf file."><figcaption>Figure 2.63 Screenshot of PLABWIN10: Finding value in the snort.conf file.</figcaption></figure><p></p>

<h4 id="cn-m16-651"><b><i>Step 21</i></b></h4>

<p id="cn-m16-652">The <b>Find Next </b>command found the keyword and makes a selection.</p>

<p id="cn-m16-653">Click and drag the <b>Find </b>dialog box out of the way, so the highlighted keyword is visible.</p>

<p id="cn-m16-654">Now change the following entry <b>$RULE_PATH/blacklist.rules </b></p>

<p id="cn-m16-655">to:</p>

<pre id="cn-m16-656"><code>$RULE_PATH\black_list.rules

</code></pre>

<p id="cn-m16-657"></p><figure><img class="cn-img" id="cn-image-m16-c-74" src="ImprovingNetworkSecurity_files/image-m16-c-74.jpg" alt="Figure 2.64 Screenshot of PLABWIN10: Finding values in the snort.conf file. The relevant entry has been changed."><figcaption>Figure 2.64 Screenshot of PLABWIN10: Finding values in the snort.conf file. The relevant entry has been changed.</figcaption></figure><p></p>

<h4 id="cn-m16-660"><b><i>Step 22</i></b></h4>

<p id="cn-m16-661">Since you do not have files available for other rules, you need to comment on the remaining rules in the <b>#site specific rules </b>section. You can comment on all of them by adding the â€œ#â€ symbol.</p>

<p id="cn-m16-662">Otherwise, you will get an error on each line where Snort finds a missing rules file.</p>

<p id="cn-m16-663">In the <b>Find </b>dialog box, click <b>Close</b>.</p>

<h4 id="cn-m16-664"><b><i>Step 23</i></b></h4>

<p id="cn-m16-665">To add the â€œ#â€ symbol to other traffic rules, click the <b>Search </b>menu and select <b>Replace</b>â€¦</p>

<p id="cn-m16-666">On the <b>Replace </b>dialog box, click in the <b>Find what </b>text box and type:</p>

<pre id="cn-m16-667"><code>include $RULE_PATH/

</code></pre>

<p id="cn-m16-668">Click in the <b>Replace with </b>text box and type:</p>

<pre id="cn-m16-669"><code>#include $RULE_PATH/

</code></pre>

<p id="cn-m16-670">Click the <b>Replace All </b>button</p>

<h4 id="cn-m16-672"><b><i>Step 24</i></b></h4>

<p id="cn-m16-673">The <b>Replace </b>dialog box reports, â€œ<b>All 104 occurrences were replaced</b>.â€</p>

<span class="cn-quote" id="cn-m16-674"><b><i>Note: </i></b><i>In your lab environment, the number of occurrences may differ.</i></span>

<p id="cn-m16-675">Click <b>Close</b>.</p>

<p id="cn-m16-676"></p><figure><img class="cn-img" id="cn-image-m16-c-75" src="ImprovingNetworkSecurity_files/image-m16-c-75.jpg" alt="Figure 2.65 Screenshot of PLABWIN10: The Replace dialog box is showing the number of instances replaced in the snort.conf file."><figcaption>Figure 2.65 Screenshot of PLABWIN10: The Replace dialog box is showing the number of instances replaced in the snort.conf file.</figcaption></figure><p></p>

<h4 id="cn-m16-679"><b><i>Step 25</i></b></h4>

<p id="cn-m16-680">Ensure that there is not a <b># </b>at the start of the following line.</p>

<p id="cn-m16-681"><b>include $RULE_PATH\black_list.rules</b></p>

<p id="cn-m16-682"></p><figure><img class="cn-img" id="cn-image-m16-c-76" src="ImprovingNetworkSecurity_files/image-m16-c-76.jpg" alt="Figure 2.66 Screenshot of PLABWIN10: Finding and ensuring values are removed in the snort.conf file."><figcaption>Figure 2.66 Screenshot of PLABWIN10: Finding and ensuring values are removed in the snort.conf file.</figcaption></figure><p></p>

<h4 id="cn-m16-685"><b><i>Step 26</i></b></h4>

<p id="cn-m16-686">Finally, click the <b>File </b>menu and select <b>Save</b>.</p>

<p id="cn-m16-687"></p><figure><img class="cn-img" id="cn-image-m16-c-77" src="ImprovingNetworkSecurity_files/image-m16-c-77.jpg" alt="Figure 2.67 Screenshot of PLABWIN10: Saving the snort.conf file after making changes."><figcaption>Figure 2.67 Screenshot of PLABWIN10: Saving the snort.conf file after making changes.</figcaption></figure><p></p>

<p id="cn-m16-690">Minimize the <b>C:\snort\etc\snort.conf  - Notepad++ (Administrator) </b>window.</p>

<h3 id="cn-m16-694"><b>Task 6 - Re-run Snort IDS tool</b></h3>

<p id="cn-m16-695">After configuring the snort.conf file in the earlier task, you will retry running the snort IDS tool.</p>

<p id="cn-m16-696">To re-run the Snort IDS tool, perform the following steps:</p>

<h4 id="cn-m16-697"><b><i>Step 1</i></b></h4>

<p id="cn-m16-698">On the <b>PLABWIN10 </b>device, restore the Command Prompt (Admin) window.</p>

<h4 id="cn-m16-699"><b><i>Step 2</i></b></h4>

<p id="cn-m16-700">Clear the window with the cls command.</p>

<p id="cn-m16-701">To test the snort configuration, type the following command and press <b>Enter</b>:</p>

<pre id="cn-m16-702"><code>snort&nbsp;-i 1&nbsp;-l&nbsp;&nbsp;c:\Snort\log&nbsp;&nbsp;-c&nbsp;&nbsp;c:\Snort\etc\snort.conf&nbsp;&nbsp;-T

</code></pre>

<p id="cn-m16-703"></p><figure><img class="cn-img" id="cn-image-m16-c-78" src="ImprovingNetworkSecurity_files/image-m16-c-78.jpg" alt="Figure 2.68 Screenshot of PLABWIN10: Entering the Snort commands. The above text has been inputted."><figcaption>Figure 2.68 Screenshot of PLABWIN10: Entering the Snort commands. The above text has been inputted.</figcaption></figure><p></p>

<h4 id="cn-m16-707"><b><i>Step 3</i></b></h4>

<p id="cn-m16-708">You should get a successful result.</p>

<p id="cn-m16-709"></p><figure><img class="cn-img" id="cn-image-m16-c-79" src="ImprovingNetworkSecurity_files/image-m16-c-79.jpg" alt="Figure 2.69 Screenshot of PLABWIN10: Validating the Snort configuration. The result is successful."><figcaption>Figure 2.69 Screenshot of PLABWIN10: Validating the Snort configuration. The result is successful.</figcaption></figure><p></p>

<h4 id="cn-m16-713"><b><i>Step 4</i></b></h4>

<p id="cn-m16-714">Enter the following command:</p>

<pre id="cn-m16-715"><code>snort&nbsp;-c&nbsp;&nbsp;c:\Snort\etc\snort.conf&nbsp;&nbsp;-l&nbsp;&nbsp;c:\Snort\log&nbsp;&nbsp;-K ascii

</code></pre>

<p id="cn-m16-716">Press <b>Enter</b>.</p>

<p id="cn-m16-717"></p><figure><img class="cn-img" id="cn-image-m16-c-80" src="ImprovingNetworkSecurity_files/image-m16-c-80.jpg" alt="Figure 2.70 Screenshot of PLABWIN10: Entering the command to start Snort in the IDS mode."><figcaption>Figure 2.70 Screenshot of PLABWIN10: Entering the command to start Snort in the IDS mode.</figcaption></figure><p></p>

<h4 id="cn-m16-720"><b><i>Step 5</i></b></h4>

<p id="cn-m16-721">Note that Snort IDS is now up and running.</p>

<p id="cn-m16-722"></p><figure><img class="cn-img" id="cn-image-m16-c-81" src="ImprovingNetworkSecurity_files/image-m16-c-81.jpg" alt="Figure 2.71 Screenshot of PLABWIN10: Showing Snort running in the IDS mode."><figcaption>Figure 2.71 Screenshot of PLABWIN10: Showing Snort running in the IDS mode.</figcaption></figure><p></p>

<span class="atom-code hidden">92fea127-9ca7-4825-8147-63c3d2f6f0d4</span>

<span class="atom-code hidden">86b3caf2-2504-4e20-a81b-2fcb2368c8d2</span>

<span class="cn-alert" id="cn-m16-728">Keep all devices that you have powered on in their current state and proceed to the review section.</span>

<div class="print-exercise-break"></div><h2 class="exercise-title" id="cn-m16-729"><b>Review</b></h2>

<p id="cn-m16-730">Well done, you have completed the <b>Improving Network Security </b>Practice Lab.</p>

<span class="atom-code hidden">2abaca70-efa1-4fe5-94fb-ad1777bfc242</span>

<span class="atom-code hidden">b6ff5d0b-b76f-4020-9694-a0a3cd7efa54</span>

<span class="atom-code hidden">6a578b7e-5e49-42c3-81ca-ebe0d8e499c2</span>

<span class="atom-code hidden">fb65e004-22fc-4c58-9075-d16e6ac194c6</span>

<span class="atom-code hidden">dfe94923-51c9-4938-b432-091ba39c0dc8</span>

<span class="atom-code hidden">649b0d0d-5c2f-4706-b5f4-0ac470c0569d</span>

<span class="atom-code hidden">aaaaaaaa-1111-1111-1111-193f35a24fe3</span>

<h2 class="cn-summary"><b>Summary</b></h2>

<p id="cn-m16-740">You completed the following exercises:</p>

<ul id="cn-m16-741">

<li id="cn-m16-741">Exercise 1 - Network Security</li>

<li id="cn-m16-742">Exercise 2 - Update Antimalware Signatures</li>

<li id="cn-m16-743">Exercise 3 - Work with Snort</li>

</ul>

<p id="cn-m16-744">You should now be able to:</p>

<ul id="cn-m16-745">

<li id="cn-m16-745">Update Windows Defender</li>

<li id="cn-m16-746">Install Snort</li>

<li id="cn-m16-747">Download Snort Rules</li>

<li id="cn-m16-748">Running Snort Tool</li>

<li id="cn-m16-749">Create a Folder and the Rules File in the Snort Folder</li>

<li id="cn-m16-750">Modify the Snort Configuration File</li>

<li id="cn-m16-751">Re-run Snort IDS tool</li>

</ul>

<p id="cn-m16-752">You should now have further knowledge of:</p>

<ul id="cn-m16-753">

<li id="cn-m16-753">Data loss Prevention (DLP)</li>

<li id="cn-m16-754">Endpoint Detection and Response (EDR)</li>

<li id="cn-m16-755">Network Access Control (NAC)</li>

<li id="cn-m16-756">Sinkholing</li>

<li id="cn-m16-757">Port Security</li>

</ul>

<h2 class="cn-feedback"><b>Feedback</b></h2>

<span class="atom-code hidden">067744a4-4299-4662-b5be-04dbb636a007</span>

<span class="cn-alert" id="cn-m16-761">Shutdown all virtual machines used in this lab. Alternatively, you can log out of the lab platform.</span>


                </div>
            </div>
        
</div>
    </div>
    </form>


</body></html>